# Техническое задание: Заметки

**Студент:** Сапронов Роман Андреевич

**Группа:** 2407сб2

---

## 1. Описание проекта

### 1.1 Название системы
Система управления личными заметками

### 1.2 Назначение
Система предназначена для хранения, редактирования и организации личных заметок пользователя. Пользователь может создавать и редактировать заметки, добавлять в избранные и добавлять категории. Категории пользователь создает сам, также может их удалять через менеджер заметок. Для того чтобы заметки работали, пользователь должен оплатить приложение.
---

## 2. Функциональные требования

### 2.1 Основные функции системы

#### Функция 1: Создание заметки
- **Описание:** Пользователь может создать новую текстовую заметку, указав заголовок (является обязательным), текст, категорию. Автоматически записывается текущая дата создания заметки. Также есть возможность добавить заметку в избранное.
- **Входные данные:** Заголовок, текст заметки, категория, дата, избранное или нет.
- **Результат:** Заметка сохранена в БД и отображается на главном окне и в окне статистики.

#### Функция 2: Редактирование заметки
- **Описание:** Позволяет изменить содержимое существующей заметки.
- **Входные данные:** ID заметки, новые данные.
- **Результат:** Заметка обновлена в базе данных.

#### Функция 3: Удаление заметки
- **Описание:** Удаление выбранной пользователем заметки.
- **Входные данные:** ID заметки.
- **Результат:** Заметка удалена из базы данных.

#### Функция 4: Добавление в избранные
- **Описание:** Позволяет пользователю отметить заметку как избранную для быстрого доступа. Избранные заметки отображаются можно отфильтровать.
- **Входные данные:** ID заметки, действие пользователя.
- **Результат:** Заметка помечена как избранная или исключена из избранного. Состояние сохраняется в базе данных.

#### Функция 5: Управление категориями
- **Описание:** Позволяет пользователю создавать и удалять собственные категории для организации заметок (например: "Работа", "Личное", "Учёба").
- **Входные данные:** Текст (для создания/редактирования), ID категории (для удаления).
- **Результат:** Новая категория добавлена, существующая удалена в базе данных. Если категория используется в какой-либо заметке - удалить ее нельзя: вылезет ошибка.

#### Функция 8: Оплата приложения
- **Описание:** Пользователь должен оплатить приложение перед использованием. Для этого он вводит данные банковской карты. Система проверяет данные карты, сохраняет информацию о платеже и, при успешной оплате, активирует доступ к дополнительным функциям.
- **Входные данные:** номер карты, срок действия, CVV, имя носителя.
- **Результат:** Приложение активировано, запись о платеже сохранена.

---

## 3. Структура базы данных

### Таблица 1: Notes (Заметки)

**Описание:** Хранит текстовые заметки, созданные пользователем.

**Поля:**
- Id (int, PK) — уникальный идентификатор заметки
- Title (string) — заголовок заметки
- Content (string) — основное содержание заметки
- CreatedAt (datetime) — дата и время создания
- IsFavorite (bool) — пометка "избранная" (true/false)
- CategoryId (List<Categories>, FK → Categories.Id) — категория заметки (nullable)

**Связи:**
- CategoryId → Categories.Id
- Многие-ко-многим с таблицей Files (одна заметка может иметь несколько категорий, как и категория может иметь несколько заметок)

### Таблица 2: Categories (Категории)

**Описание:** Хранит категории, созданные пользователем для группировки заметок.

**Поля:**
- Id (int, PK) — уникальный идентификатор категории
- Name (string) — название категории

**Связи:**
- Многие-ко-многим с Notes (одна заметка может иметь несколько категорий, как и категория может иметь несколько заметок)

## 4. Основные формы приложения

#### Форма 1: MainWindow (Главная форма)

**Назначение:** Основное окно для просмотра и управления заметками.

**Элементы управления:**
- DataGrid — список всех заметок
- ComboBox (категории) - фильтрация по категории
- CheckBox (избранные) - отображение только избранных заметок

**Действия:**
- Кнопка "Создать заметку" - открывает NoteEditWindow для создания новой заметки
- Двойной нажатие по элементу DataGrid "Редактировать" - открывает NoteEditWindow с выбранной заметкой
- Кнопка "Удалить заметку" — удаляет выбранную заметку
- Кнопка "Категории" — открывает CategoryManagerWindow
- Кнопка "Обновить" - обновляет данные на форме
- Кнопка "Статистика" - открывает StatisticsWindow

#### Форма 2: NoteEditWindow

**Назначение:** Создание или редактирование заметки.

**Элементы управления:**
- TextBox (Заголовок) - ввод заголовка
- TextBox (Содержание) - ввод текста заметки
- Checkbox (Избранное) - добавление заметки в избранное

**Действия:**
- Кнопка "Сохранить" - сохраняет изменения
- Кнопка "Отмена" - закрывает окно без сохранения
- Кнопка "Выбрать категории" - открывает CategoryCelectionWindow

#### Форма 3: CategoryManagerWindow

**Назначение:** Управление категориями (просмотр, создание, удаление).

**Элементы управления:**
- ItemsControl - список существующих категорий
- TextBlock (Название категории) - отображение категории
- TextBox (Название новой категории) - задает имя новой категории

**Действия:**
- Button (Добавить) — создает новую категорию с именем из TextBox
- Button (Удалить) — удаляет выбранную категорию. Если категория используется в какой-либо заметке - удалить ее нельзя: вылезет ошибка.
- Button (Закрыть) — закрывает окно

#### Форма 4: CategoryСelectionWindow

**Назначение:** Добавление категории к заметки, также создание новой категории.

**Элементы управления:**
- ItemsControl - список существующих категорий
- Checkbox - если активирован, категория добавляется к заметке
- TextBlock (Название категории) - отображение категории
- TextBox (Название новой категории) - задает имя новой категории

**Действия:**
- Button (Добавить) — создает новую категорию с именем из TextBox
- Button (Сохранить) — сохраняет категории для заметки и закрывает окно
- Button (Отмена) — закрывает окно без изменений

#### Форма 5: PaymentWindow

**Назначение:** Покупка доступа к приложению.

**Элементы управления:**
- TextBox (номер карты) — ввод номера карты
- TextBox (срок действия) — MM/YY
- TextBox (CVV) — код безопасности
- TextBox (имя держателя) — имя держателя

**Действия:**
- Кнопка "Оплатить" - проверяет данные, создает файл оплаты, открывает доступ к приложению

#### Форма 6: StatisticsWindow

**Назначение:** Просмотр статистики приложения.

**Элементы управления:**
- TabItem (статистика по месяцам) — вкладка со статистикой по месяцам
- TabItem (статистика по категориям) — вкладка со статистикой по категориям
- PlotView (круговая диаграмма) - отображение диаграммы
- TextBlock (легенда) - отображение информации
- DatePicker (выбор периода даты) - фильтрация заметок по дате создания

**Действия:**
- Кнопка "Обновить" - обновляет данные на форме
- Кнопка "Текущий год" - отображает статистику за текущий год
- Кнопка "Все время" - отображает статистику за все время
- Кнопка "Обновить" - обновляет данные на форме
- Кнопка "По возрастанию" - сортирует данные по возрастанию
- Кнопка "По убыванию" - сортирует данные по убыванию

---

## 5. Схема переходов между формами

### При запуске приложения

1. **Запуск** → MainWindow (главная форма со списком заметок)

### Из MainWindow (Главная форма)

1. **Кнопка "Создать заметку"** → NoteEditWindow (режим создания)
2. **Двойной клик "Редактировать" (при выборе заметки)** → NoteEditWindow (режим редактирования)
3. **Кнопка "Удалить"** → диалог подтверждения → удаление, остаёмся на MainWindow
4. **Кнопка "Категории"** → CategoryManagerWindow
5. **Кнопка "Статистика"** → StatisticsWindow

### Из NoteEditWindow (Создание/редактирование заметки)

1. **Кнопка "Сохранить"** → сохранение заметки → возврат на MainWindow (обновлённый список)
2. **Кнопка "Отмена"** → возврат на MainWindow без сохранения
3. **Кнопка "Выбрать категории"** → CategoryCelectionWindow

### Из CategoryManagerWindow (Управление категориями)

1. **Кнопка "Добавить"** → сохранение новой категории → обновление списка в окне
3. **Кнопка "Удалить"** → диалог подтверждения → удаление категории → обновление списка в окне
4. **Кнопка "Закрыть"** → возврат на MainWindow

### Из CategoryCelectionWindow (Добавление категорий к заметке)

1. **Кнопка "Добавить"** → сохранение новой категории → обновление списка в окне
2. **Кнопка "Отмена"** → возврат на NoteEditWindow
3. **Кнопка "Сохранить"** → возврат на NoteEditWindow

### Из PaymentWindow (Покупка доступа)

1. **Кнопка "Оплатить"**
    1.1. **Успешная оплата** → сообщение об успехе → переход на MainWindow