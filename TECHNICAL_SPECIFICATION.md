# Техническое задание: Заметки

**Студент:** Сапронов Роман Андреевич

**Группа:** 2407сб2

---

## 1. Описание проекта

### 1.1 Название системы
Система управления личными заметками

### 1.2 Назначение
Система предназначена для хранения, редактирования и организации личных заметок пользователя. Пользователь может создавать и редактировать заметки, добавлять в избранные, а также менять тему приложения. Также пользователь может приобрести подписку для расширения функционала: разделение заметок на категории и возможность прикрепления файлов.

---

## 2. Функциональные требования

### 2.1 Основные функции системы

#### Функция 1: Создание заметки
- **Описание:** Пользователь может создать новую текстовую заметку, указав заголовок, текст, категорию. Автоматически записывается дата заметки.
- **Входные данные:** Заголовок, текст заметки, категория.
- **Результат:** Заметка сохранена в БД и отображается в списке.

#### Функция 2: Редактирование заметки
- **Описание:** Позволяет изменить содержимое существующей заметки.
- **Входные данные:** ID заметки, новые данные.
- **Результат:** Заметка обновлена в базе данных.

#### Функция 3: Удаление заметки
- **Описание:** Удаление выбранной пользователем заметки.
- **Входные данные:** ID заметки.
- **Результат:** Заметка удалена из базы данных.

#### Функция 4: Добавление в избранные
- **Описание:** Позволяет пользователю отметить заметку как избранную для быстрого доступа. Избранные заметки отображаются в отдельном разделе.
- **Входные данные:** ID заметки, действие пользователя.
- **Результат:** Заметка помечена как избранная или исключена из избранного. Состояние сохраняется в базе данных.

\\ Нет удаления и редактирования категорий
#### Функция 5: Добавление категории
- **Описание:** Позволяет пользователю создавать собственные категории для организации заметок (например: "Работа", "Личное", "Учёба").
- **Входные данные:** Текст.
- **Результат:** Новая категория добавлена в базу данных и доступна для назначения заметкам.

#### Функция 6: Прикрепление файла
- **Описание:** Позволяет прикреплять к заметке файлы (изображения, документы и др.) для хранения дополнительных материалов.
- **Входные данные:** ID заметки, путь к файлу или файл из диалога выбора.
- **Результат:** Файл сохранён в системе и связан с соответствующей заметкой.

#### Функция 7: Оплата подписки
- **Описание:** Пользователь может оформить платную подписку (месячную или годовую), вводя данные банковской карты. Система проверяет карту, сохраняет информацию о платеже и, при успешной оплате, активирует доступ к дополнительным функциям.
- **Входные данные:** Выбранный тариф, номер карты, срок действия, CVV.
- **Результат:** Подписка активирована, запись о платеже создана в БД.

---

## 3. Структура базы данных

### Таблица 1: Notes (Заметки)

**Описание:** Хранит текстовые заметки, созданные пользователем.

**Поля:**
- Id (int, PK) — уникальный идентификатор заметки

- Title (string) — заголовок заметки

- Content (string) — основное содержание заметки

- CreatedAt (datetime) — дата и время создания

- IsFavorite (bool) — пометка "избранная" (true/false)

- CategoryId (int?, FK → Categories.Id) — категория заметки (nullable)

**Связи:**

- CategoryId → Categories.Id

- Один-ко-многим с таблицей Files (одна заметка может иметь несколько файлов)

### Таблица 2: Categories (Категории)

Описание: Хранит категории, созданные пользователем для группировки заметок.

**Поля:**
- Id (int, PK) — уникальный идентификатор категории

- Name (string) — название категории

- CreatedAt (datetime) — дата создания категории

**Связи:**
- Один-ко-многим с Notes (одна категория может быть у нескольких заметок)

### Таблица 3: Files (Файлы)

Описание: Хранит информацию о прикреплённых к заметкам файлах.

**Поля:**
- Id (int, PK) — уникальный идентификатор файла

- NoteId (int, FK → Notes.Id) — ID заметки, к которой прикреплён файл

- FileName (string) — имя файла

- FilePath (string) — путь к файлу на диске или в облаке // стоит копировать в папку программы.

- UploadedAt (datetime) — дата загрузки файла

**Связи:**
- NoteId → Notes.Id

### Таблица 4: Payments (Платежи)

Описание: Хранит информацию о платежах пользователей за подписку.

**Поля:**
- Id (int, PK) — уникальный идентификатор платежа

- PaymentDate (datetime) — дата оплаты

- Tariff (string) — выбранный тариф (месячная, годовая)

- CardMasked (string) — маскированный номер карты (**** **** **** 1234) // не хранить

- SubscriptionEndDate (datetime) — дата окончания подписки

**Связи:**

Нет внешних ключей (если нет регистрации пользователя).

## 4. Основные формы приложения

#### Форма 1: MainWindow (Главная форма)

**Назначение:** Основное окно для просмотра и управления заметками.

**Элементы управления:**

- DataGrid — список всех заметок

- ComboBox (категории) — фильтрация по категории

- CheckBox (избранные) — отображение только избранных заметок

- Menu (Навигация) — доступ к формам "Создать", "Оплата", "Темы", и др.

**Действия:**

- Кнопка "Создать заметку" — открывает NoteEditWindow

- Кнопка "Редактировать" — открывает NoteEditWindow с выбранной заметкой

- Кнопка "Удалить" — удаляет выбранную заметку

- Кнопка "Оплатить подписку" — открывает PaymentWindow

- Кнопка "Добавить категорию" — открывает CategoryWindow (если подписка активна)

- Кнопка "Тема" — позволяет изменить тему приложения.

```

#### Форма 2: NoteEditWindow

**Назначение:** Создание или редактирование заметки.

**Элементы управления:**

- TextBox (Заголовок) — ввод заголовка

- TextBox (Содержание) — ввод текста заметки

- ComboBox (Категория) — выбор категории (если подписка активна)

- Button (Прикрепить файл) — выбор файла // отобразить файл в форме редактирования

- ListBox — список прикреплённых файлов

**Действия:**

- Кнопка "Сохранить" — сохраняет изменения

- Кнопка "Отмена" — закрывает окно без сохранения

```

#### Форма 3: CategoryWindow

**Назначение:** Добавление новой категории.

**Элементы управления:**

- TextBox (Название категории) — ввод названия новой категории

**Действия:**

- Кнопка "Создать" — сохраняет категорию

- Кнопка "Отмена" — отменяет добавление

```

#### Форма 4: PaymentWindow

**Назначение:** Оформление подписки.

**Элементы управления:**

- ComboBox (тариф) — выбор тарифа: "Месяц", "Год"

- TextBox (номер карты) — ввод номера карты

- TextBox (срок действия) — MM/YY

- TextBox (CVV) — код безопасности

- TextBlock — отображение стоимости

**Действия:**

- Кнопка "Оплатить" — обработка и сохранение платежа

- Кнопка "Отмена" — закрытие формы без оплаты

```

#### Форма 5: FilePreviewWindow (опционально)

**Назначение:** Просмотр/открытие прикреплённых файлов.

**Элементы управления:**

- ListBox — список файлов

- Preview/Viewer (если поддерживается)

**Действия:**

- Кнопка "Открыть файл" — открывает файл во внешнем приложении

- Кнопка "Удалить файл" — удаляет файл из заметки

---

## 5. Схема переходов между формами

### При запуске приложения

1. **Запуск** → MainWindow (главная форма со списком заметок)

### Из MainWindow (Главная форма)

1. **Кнопка "Создать заметку"** → NoteEditWindow (режим создания)

2. **Кнопка "Редактировать" (при выборе заметки)** → NoteEditWindow (режим редактирования)

3. **Кнопка "Удалить"** → диалог подтверждения → удаление, остаёмся на MainWindow

4. **Кнопка "Добавить категорию"** (если подписка активна) → CategoryWindow

5. **Кнопка "Оплатить подписку"** → PaymentWindow

6. **Кнопка "Тема"** → смена темы приложения (без перехода на новую форму)

### Из NoteEditWindow (Создание/редактирование заметки)

1. **Кнопка "Сохранить"** → сохранение заметки → возврат на MainWindow (обновлённый список)

2. **Кнопка "Отмена"** → возврат на MainWindow без сохранения

### Из CategoryWindow (Добавление категории)

1. **Кнопка "Создать"** → сохранение категории → возврат на MainWindow

2. **Кнопка "Отмена"** → возврат на MainWindow

### Из PaymentWindow (Оформление подписки)

1. **Кнопка "Оплатить"**

1.1. **Успешная оплата** → сообщение об успехе → возврат на MainWindow

1.2. **Ошибка оплаты** → сообщение об ошибке → остаёмся в PaymentWindow

2. **Кнопка "Отмена"** → возврат на MainWindow

### Из FilePreviewWindow (если реализовано)

1. **Доступ из NoteEditWindow по кнопке "Открыть файл"**

2. **"Удалить файл"** → удаление файла из заметки → возврат к NoteEditWindow

3. **"Открыть файл" → внешний просмотр → возврат к FilePreviewWindow